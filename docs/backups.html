<!DOCTYPE html>

<html>
<head>
  <title>Automatic Backups</title>
  <link href="search/tipuesearch.css" rel="stylesheet">
  <link href="style.css" rel="stylesheet">
</head>

<body class="page--backups">
<header>
  <div class="pager"><a href="index.html" class="prev index">&laquo;Index</a><a href="index.html" class="index pager__book-title"></a><a href="CHANGELOG.html" class="next changelog">Changelog&raquo;</a></div></header>
<section class="sub-header">
  <div class="breadcrumbs"><a href="index.html">Index</a>
         &raquo
      </div>      <div class="search__wrapper">
  <form action="search--results.html">
    <input type="text" class="search-input" name="q" id="tipue_search_input" autocomplete="off" required>
  </form>
</div>
  </section>


<h1>Automatic Backups</h1>

<section>

<p>Enable backups by doing the following:</p>

<ol>
<li>Enable the <a href="https://github.com/aklump/drupal_usage_cron">Usage Cron module</a>.</li>
<li><p>Add the following to <em>settings.local.php</em> to turn on backups.</p>

<pre><code>$config['loft_dev.settings']['usage_cron_backups'] = TRUE;
</code></pre></li>
</ol>

<p>@todo Update the rest of this, I think it doesn't apply to d8 anymore.</p>

<p>Loft Dev Module can automatically call <code>loft_deploy export</code> on regular intervals of use.  <a href="https://github.com/aklump/loft_deploy">Loft Deploy</a> must already be installed and configured for your project.  This has the effect of automatically backing up the database to the normal <em>Loft Deploy</em> output path, for every N minutes of <strong>active</strong> use.</p>

<pre><code>.
├── my_db_name-auto_2019-05-05_1906.sql.gz
├── my_db_name-auto_2019-05-05_1901.sql.gz
└── my_db_name-auto_2019-05-05_1856.sql.gz
</code></pre>

<p>This is not based on cron, but rather on elapsed time.  If you set this to back up every 15 minutes, it will only do so if you're activaly using the site.  It's like poor man's cron, it looks to see if N minutes has elapsed since the last backup, and it does this on a page load.  Thus, no use, no page load.  The following settings needed to be added to <em>settings.local.php</em>.</p>

<p><code>loft_deploy purge</code> is also called based on <code>$config['loft_dev.settings']['loft_deploy_purge_after_days']</code>, which will keep your total file count down.</p>

<h2>Configuration</h2>

<pre><code>$config['loft_dev.settings']['which_loft_deploy'] = '/Users/aklump/bin/loft_deploy';
$config['loft_dev.settings']['loft_deploy_export_period_mins'] = 5;
$config['loft_dev.settings']['loft_deploy_purge_after_days'] = 3;
</code></pre>

<p>To disable simply comment out the above lines.</p>
</section>

<div class="search__results">
  <div id="tipue_search_content"></div>
</div>

<footer>
  <div class="pager"><a href="index.html" class="prev index">&laquo;Index</a><a href="index.html" class="index pager__book-title"></a><a href="CHANGELOG.html" class="next changelog">Changelog&raquo;</a></div>  
  <div id="footer-legaleeze">
    <p class="legaleeze center">Version: 1.0 &bull; Last Updated: Fri, 08 May 2020 17:59:27 -0700</p>
  </div>
</footer>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="search/tipuesearch_content.js"></script>
  <script src="search/tipuesearch_set.js"></script>
  <script src="search/tipuesearch.min.js"></script>
  <script>
    $(document).ready(function() {
      $('#tipue_search_input').tipuesearch()
    })
  </script>
<script src="js/core.js"></script>
</body>
</html>

